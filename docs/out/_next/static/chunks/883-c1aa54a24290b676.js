(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[883],{35:function(t,e,r){"use strict";var n=r(1135).lW;let o=void 0!==n,i=/"(?:_|\\u005[Ff])(?:_|\\u005[Ff])(?:p|\\u0070)(?:r|\\u0072)(?:o|\\u006[Ff])(?:t|\\u0074)(?:o|\\u006[Ff])(?:_|\\u005[Ff])(?:_|\\u005[Ff])"\s*:/,a=/"(?:c|\\u0063)(?:o|\\u006[Ff])(?:n|\\u006[Ee])(?:s|\\u0073)(?:t|\\u0074)(?:r|\\u0072)(?:u|\\u0075)(?:c|\\u0063)(?:t|\\u0074)(?:o|\\u006[Ff])(?:r|\\u0072)"\s*:/;function s(t,e,r){null==r&&null!==e&&"object"==typeof e&&(r=e,e=void 0),o&&n.isBuffer(t)&&(t=t.toString()),t&&65279===t.charCodeAt(0)&&(t=t.slice(1));let s=JSON.parse(t,e);if(null===s||"object"!=typeof s)return s;let l=r&&r.protoAction||"error",f=r&&r.constructorAction||"error";if("ignore"===l&&"ignore"===f)return s;if("ignore"!==l&&"ignore"!==f){if(!1===i.test(t)&&!1===a.test(t))return s}else if("ignore"!==l&&"ignore"===f){if(!1===i.test(t))return s}else if(!1===a.test(t))return s;return u(s,{protoAction:l,constructorAction:f,safe:r&&r.safe})}function u(t,{protoAction:e="error",constructorAction:r="error",safe:n}={}){let o=[t];for(;o.length;){let t=o;for(let i of(o=[],t)){if("ignore"!==e&&Object.prototype.hasOwnProperty.call(i,"__proto__")){if(!0===n)return null;if("error"===e)throw SyntaxError("Object contains forbidden prototype property");delete i.__proto__}if("ignore"!==r&&Object.prototype.hasOwnProperty.call(i,"constructor")&&Object.prototype.hasOwnProperty.call(i.constructor,"prototype")){if(!0===n)return null;if("error"===r)throw SyntaxError("Object contains forbidden prototype property");delete i.constructor}for(let t in i){let e=i[t];e&&"object"==typeof e&&o.push(e)}}}return t}function l(t,e,r){let n=Error.stackTraceLimit;Error.stackTraceLimit=0;try{return s(t,e,r)}finally{Error.stackTraceLimit=n}}t.exports=l,t.exports.default=l,t.exports.parse=l,t.exports.safeParse=function(t,e){let r=Error.stackTraceLimit;Error.stackTraceLimit=0;try{return s(t,e,{safe:!0})}catch(t){return null}finally{Error.stackTraceLimit=r}},t.exports.scan=u},4492:function(t,e,r){"use strict";/**
 * @license React
 * use-sync-external-store-shim.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var n=r(2265),o="function"==typeof Object.is?Object.is:function(t,e){return t===e&&(0!==t||1/t==1/e)||t!=t&&e!=e},i=n.useState,a=n.useEffect,s=n.useLayoutEffect,u=n.useDebugValue;function l(t){var e=t.getSnapshot;t=t.value;try{var r=e();return!o(t,r)}catch(t){return!0}}var f="undefined"==typeof window||void 0===window.document||void 0===window.document.createElement?function(t,e){return e()}:function(t,e){var r=e(),n=i({inst:{value:r,getSnapshot:e}}),o=n[0].inst,f=n[1];return s(function(){o.value=r,o.getSnapshot=e,l(o)&&f({inst:o})},[t,r,e]),a(function(){return l(o)&&f({inst:o}),t(function(){l(o)&&f({inst:o})})},[t]),u(r),r};e.useSyncExternalStore=void 0!==n.useSyncExternalStore?n.useSyncExternalStore:f},554:function(t,e,r){"use strict";t.exports=r(4492)},734:function(t,e){"use strict";e.byteLength=function(t){var e=u(t),r=e[0],n=e[1];return(r+n)*3/4-n},e.toByteArray=function(t){var e,r,i=u(t),a=i[0],s=i[1],l=new o((a+s)*3/4-s),f=0,c=s>0?a-4:a;for(r=0;r<c;r+=4)e=n[t.charCodeAt(r)]<<18|n[t.charCodeAt(r+1)]<<12|n[t.charCodeAt(r+2)]<<6|n[t.charCodeAt(r+3)],l[f++]=e>>16&255,l[f++]=e>>8&255,l[f++]=255&e;return 2===s&&(e=n[t.charCodeAt(r)]<<2|n[t.charCodeAt(r+1)]>>4,l[f++]=255&e),1===s&&(e=n[t.charCodeAt(r)]<<10|n[t.charCodeAt(r+1)]<<4|n[t.charCodeAt(r+2)]>>2,l[f++]=e>>8&255,l[f++]=255&e),l},e.fromByteArray=function(t){for(var e,n=t.length,o=n%3,i=[],a=0,s=n-o;a<s;a+=16383)i.push(function(t,e,n){for(var o,i=[],a=e;a<n;a+=3)i.push(r[(o=(t[a]<<16&16711680)+(t[a+1]<<8&65280)+(255&t[a+2]))>>18&63]+r[o>>12&63]+r[o>>6&63]+r[63&o]);return i.join("")}(t,a,a+16383>s?s:a+16383));return 1===o?i.push(r[(e=t[n-1])>>2]+r[e<<4&63]+"=="):2===o&&i.push(r[(e=(t[n-2]<<8)+t[n-1])>>10]+r[e>>4&63]+r[e<<2&63]+"="),i.join("")};for(var r=[],n=[],o="undefined"!=typeof Uint8Array?Uint8Array:Array,i="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",a=0,s=i.length;a<s;++a)r[a]=i[a],n[i.charCodeAt(a)]=a;function u(t){var e=t.length;if(e%4>0)throw Error("Invalid string. Length must be a multiple of 4");var r=t.indexOf("=");-1===r&&(r=e);var n=r===e?0:4-r%4;return[r,n]}n["-".charCodeAt(0)]=62,n["_".charCodeAt(0)]=63},1135:function(t,e,r){"use strict";/*!
 * The buffer module from node.js, for the browser.
 *
 * @author   Feross Aboukhadijeh <http://feross.org>
 * @license  MIT
 */var n=r(734),o=r(2344),i=r(426);function a(){return u.TYPED_ARRAY_SUPPORT?2147483647:1073741823}function s(t,e){if(a()<e)throw RangeError("Invalid typed array length");return u.TYPED_ARRAY_SUPPORT?(t=new Uint8Array(e)).__proto__=u.prototype:(null===t&&(t=new u(e)),t.length=e),t}function u(t,e,r){if(!u.TYPED_ARRAY_SUPPORT&&!(this instanceof u))return new u(t,e,r);if("number"==typeof t){if("string"==typeof e)throw Error("If encoding is specified then the first argument must be a string");return c(this,t)}return l(this,t,e,r)}function l(t,e,r,n){if("number"==typeof e)throw TypeError('"value" argument must not be a number');return"undefined"!=typeof ArrayBuffer&&e instanceof ArrayBuffer?function(t,e,r,n){if(e.byteLength,r<0||e.byteLength<r)throw RangeError("'offset' is out of bounds");if(e.byteLength<r+(n||0))throw RangeError("'length' is out of bounds");return e=void 0===r&&void 0===n?new Uint8Array(e):void 0===n?new Uint8Array(e,r):new Uint8Array(e,r,n),u.TYPED_ARRAY_SUPPORT?(t=e).__proto__=u.prototype:t=h(t,e),t}(t,e,r,n):"string"==typeof e?function(t,e,r){if(("string"!=typeof r||""===r)&&(r="utf8"),!u.isEncoding(r))throw TypeError('"encoding" must be a valid string encoding');var n=0|p(e,r),o=(t=s(t,n)).write(e,r);return o!==n&&(t=t.slice(0,o)),t}(t,e,r):function(t,e){if(u.isBuffer(e)){var r,n=0|d(e.length);return 0===(t=s(t,n)).length||e.copy(t,0,0,n),t}if(e){if("undefined"!=typeof ArrayBuffer&&e.buffer instanceof ArrayBuffer||"length"in e)return"number"!=typeof e.length||(r=e.length)!=r?s(t,0):h(t,e);if("Buffer"===e.type&&i(e.data))return h(t,e.data)}throw TypeError("First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.")}(t,e)}function f(t){if("number"!=typeof t)throw TypeError('"size" argument must be a number');if(t<0)throw RangeError('"size" argument must not be negative')}function c(t,e){if(f(e),t=s(t,e<0?0:0|d(e)),!u.TYPED_ARRAY_SUPPORT)for(var r=0;r<e;++r)t[r]=0;return t}function h(t,e){var r=e.length<0?0:0|d(e.length);t=s(t,r);for(var n=0;n<r;n+=1)t[n]=255&e[n];return t}function d(t){if(t>=a())throw RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+a().toString(16)+" bytes");return 0|t}function p(t,e){if(u.isBuffer(t))return t.length;if("undefined"!=typeof ArrayBuffer&&"function"==typeof ArrayBuffer.isView&&(ArrayBuffer.isView(t)||t instanceof ArrayBuffer))return t.byteLength;"string"!=typeof t&&(t=""+t);var r=t.length;if(0===r)return 0;for(var n=!1;;)switch(e){case"ascii":case"latin1":case"binary":return r;case"utf8":case"utf-8":case void 0:return S(t).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*r;case"hex":return r>>>1;case"base64":return P(t).length;default:if(n)return S(t).length;e=(""+e).toLowerCase(),n=!0}}function g(t,e,r){var o,i,a=!1;if((void 0===e||e<0)&&(e=0),e>this.length||((void 0===r||r>this.length)&&(r=this.length),r<=0||(r>>>=0)<=(e>>>=0)))return"";for(t||(t="utf8");;)switch(t){case"hex":return function(t,e,r){var n,o=t.length;(!e||e<0)&&(e=0),(!r||r<0||r>o)&&(r=o);for(var i="",a=e;a<r;++a)i+=(n=t[a])<16?"0"+n.toString(16):n.toString(16);return i}(this,e,r);case"utf8":case"utf-8":return w(this,e,r);case"ascii":return function(t,e,r){var n="";r=Math.min(t.length,r);for(var o=e;o<r;++o)n+=String.fromCharCode(127&t[o]);return n}(this,e,r);case"latin1":case"binary":return function(t,e,r){var n="";r=Math.min(t.length,r);for(var o=e;o<r;++o)n+=String.fromCharCode(t[o]);return n}(this,e,r);case"base64":return o=e,i=r,0===o&&i===this.length?n.fromByteArray(this):n.fromByteArray(this.slice(o,i));case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return function(t,e,r){for(var n=t.slice(e,r),o="",i=0;i<n.length;i+=2)o+=String.fromCharCode(n[i]+256*n[i+1]);return o}(this,e,r);default:if(a)throw TypeError("Unknown encoding: "+t);t=(t+"").toLowerCase(),a=!0}}function y(t,e,r){var n=t[e];t[e]=t[r],t[r]=n}function v(t,e,r,n,o){if(0===t.length)return -1;if("string"==typeof r?(n=r,r=0):r>2147483647?r=2147483647:r<-2147483648&&(r=-2147483648),isNaN(r=+r)&&(r=o?0:t.length-1),r<0&&(r=t.length+r),r>=t.length){if(o)return -1;r=t.length-1}else if(r<0){if(!o)return -1;r=0}if("string"==typeof e&&(e=u.from(e,n)),u.isBuffer(e))return 0===e.length?-1:m(t,e,r,n,o);if("number"==typeof e)return(e&=255,u.TYPED_ARRAY_SUPPORT&&"function"==typeof Uint8Array.prototype.indexOf)?o?Uint8Array.prototype.indexOf.call(t,e,r):Uint8Array.prototype.lastIndexOf.call(t,e,r):m(t,[e],r,n,o);throw TypeError("val must be string, number or Buffer")}function m(t,e,r,n,o){var i,a=1,s=t.length,u=e.length;if(void 0!==n&&("ucs2"===(n=String(n).toLowerCase())||"ucs-2"===n||"utf16le"===n||"utf-16le"===n)){if(t.length<2||e.length<2)return -1;a=2,s/=2,u/=2,r/=2}function l(t,e){return 1===a?t[e]:t.readUInt16BE(e*a)}if(o){var f=-1;for(i=r;i<s;i++)if(l(t,i)===l(e,-1===f?0:i-f)){if(-1===f&&(f=i),i-f+1===u)return f*a}else -1!==f&&(i-=i-f),f=-1}else for(r+u>s&&(r=s-u),i=r;i>=0;i--){for(var c=!0,h=0;h<u;h++)if(l(t,i+h)!==l(e,h)){c=!1;break}if(c)return i}return -1}function w(t,e,r){r=Math.min(t.length,r);for(var n=[],o=e;o<r;){var i,a,s,u,l=t[o],f=null,c=l>239?4:l>223?3:l>191?2:1;if(o+c<=r)switch(c){case 1:l<128&&(f=l);break;case 2:(192&(i=t[o+1]))==128&&(u=(31&l)<<6|63&i)>127&&(f=u);break;case 3:i=t[o+1],a=t[o+2],(192&i)==128&&(192&a)==128&&(u=(15&l)<<12|(63&i)<<6|63&a)>2047&&(u<55296||u>57343)&&(f=u);break;case 4:i=t[o+1],a=t[o+2],s=t[o+3],(192&i)==128&&(192&a)==128&&(192&s)==128&&(u=(15&l)<<18|(63&i)<<12|(63&a)<<6|63&s)>65535&&u<1114112&&(f=u)}null===f?(f=65533,c=1):f>65535&&(f-=65536,n.push(f>>>10&1023|55296),f=56320|1023&f),n.push(f),o+=c}return function(t){var e=t.length;if(e<=4096)return String.fromCharCode.apply(String,t);for(var r="",n=0;n<e;)r+=String.fromCharCode.apply(String,t.slice(n,n+=4096));return r}(n)}function _(t,e,r){if(t%1!=0||t<0)throw RangeError("offset is not uint");if(t+e>r)throw RangeError("Trying to access beyond buffer length")}function b(t,e,r,n,o,i){if(!u.isBuffer(t))throw TypeError('"buffer" argument must be a Buffer instance');if(e>o||e<i)throw RangeError('"value" argument is out of bounds');if(r+n>t.length)throw RangeError("Index out of range")}function E(t,e,r,n){e<0&&(e=65535+e+1);for(var o=0,i=Math.min(t.length-r,2);o<i;++o)t[r+o]=(e&255<<8*(n?o:1-o))>>>(n?o:1-o)*8}function A(t,e,r,n){e<0&&(e=4294967295+e+1);for(var o=0,i=Math.min(t.length-r,4);o<i;++o)t[r+o]=e>>>(n?o:3-o)*8&255}function R(t,e,r,n,o,i){if(r+n>t.length||r<0)throw RangeError("Index out of range")}function T(t,e,r,n,i){return i||R(t,e,r,4,34028234663852886e22,-34028234663852886e22),o.write(t,e,r,n,23,4),r+4}function x(t,e,r,n,i){return i||R(t,e,r,8,17976931348623157e292,-17976931348623157e292),o.write(t,e,r,n,52,8),r+8}e.lW=u,e.h2=50,u.TYPED_ARRAY_SUPPORT=void 0!==r.g.TYPED_ARRAY_SUPPORT?r.g.TYPED_ARRAY_SUPPORT:function(){try{var t=new Uint8Array(1);return t.__proto__={__proto__:Uint8Array.prototype,foo:function(){return 42}},42===t.foo()&&"function"==typeof t.subarray&&0===t.subarray(1,1).byteLength}catch(t){return!1}}(),a(),u.poolSize=8192,u._augment=function(t){return t.__proto__=u.prototype,t},u.from=function(t,e,r){return l(null,t,e,r)},u.TYPED_ARRAY_SUPPORT&&(u.prototype.__proto__=Uint8Array.prototype,u.__proto__=Uint8Array,"undefined"!=typeof Symbol&&Symbol.species&&u[Symbol.species]===u&&Object.defineProperty(u,Symbol.species,{value:null,configurable:!0})),u.alloc=function(t,e,r){return(f(t),t<=0)?s(null,t):void 0!==e?"string"==typeof r?s(null,t).fill(e,r):s(null,t).fill(e):s(null,t)},u.allocUnsafe=function(t){return c(null,t)},u.allocUnsafeSlow=function(t){return c(null,t)},u.isBuffer=function(t){return!!(null!=t&&t._isBuffer)},u.compare=function(t,e){if(!u.isBuffer(t)||!u.isBuffer(e))throw TypeError("Arguments must be Buffers");if(t===e)return 0;for(var r=t.length,n=e.length,o=0,i=Math.min(r,n);o<i;++o)if(t[o]!==e[o]){r=t[o],n=e[o];break}return r<n?-1:n<r?1:0},u.isEncoding=function(t){switch(String(t).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},u.concat=function(t,e){if(!i(t))throw TypeError('"list" argument must be an Array of Buffers');if(0===t.length)return u.alloc(0);if(void 0===e)for(r=0,e=0;r<t.length;++r)e+=t[r].length;var r,n=u.allocUnsafe(e),o=0;for(r=0;r<t.length;++r){var a=t[r];if(!u.isBuffer(a))throw TypeError('"list" argument must be an Array of Buffers');a.copy(n,o),o+=a.length}return n},u.byteLength=p,u.prototype._isBuffer=!0,u.prototype.swap16=function(){var t=this.length;if(t%2!=0)throw RangeError("Buffer size must be a multiple of 16-bits");for(var e=0;e<t;e+=2)y(this,e,e+1);return this},u.prototype.swap32=function(){var t=this.length;if(t%4!=0)throw RangeError("Buffer size must be a multiple of 32-bits");for(var e=0;e<t;e+=4)y(this,e,e+3),y(this,e+1,e+2);return this},u.prototype.swap64=function(){var t=this.length;if(t%8!=0)throw RangeError("Buffer size must be a multiple of 64-bits");for(var e=0;e<t;e+=8)y(this,e,e+7),y(this,e+1,e+6),y(this,e+2,e+5),y(this,e+3,e+4);return this},u.prototype.toString=function(){var t=0|this.length;return 0===t?"":0==arguments.length?w(this,0,t):g.apply(this,arguments)},u.prototype.equals=function(t){if(!u.isBuffer(t))throw TypeError("Argument must be a Buffer");return this===t||0===u.compare(this,t)},u.prototype.inspect=function(){var t="",r=e.h2;return this.length>0&&(t=this.toString("hex",0,r).match(/.{2}/g).join(" "),this.length>r&&(t+=" ... ")),"<Buffer "+t+">"},u.prototype.compare=function(t,e,r,n,o){if(!u.isBuffer(t))throw TypeError("Argument must be a Buffer");if(void 0===e&&(e=0),void 0===r&&(r=t?t.length:0),void 0===n&&(n=0),void 0===o&&(o=this.length),e<0||r>t.length||n<0||o>this.length)throw RangeError("out of range index");if(n>=o&&e>=r)return 0;if(n>=o)return -1;if(e>=r)return 1;if(e>>>=0,r>>>=0,n>>>=0,o>>>=0,this===t)return 0;for(var i=o-n,a=r-e,s=Math.min(i,a),l=this.slice(n,o),f=t.slice(e,r),c=0;c<s;++c)if(l[c]!==f[c]){i=l[c],a=f[c];break}return i<a?-1:a<i?1:0},u.prototype.includes=function(t,e,r){return -1!==this.indexOf(t,e,r)},u.prototype.indexOf=function(t,e,r){return v(this,t,e,r,!0)},u.prototype.lastIndexOf=function(t,e,r){return v(this,t,e,r,!1)},u.prototype.write=function(t,e,r,n){if(void 0===e)n="utf8",r=this.length,e=0;else if(void 0===r&&"string"==typeof e)n=e,r=this.length,e=0;else if(isFinite(e))e|=0,isFinite(r)?(r|=0,void 0===n&&(n="utf8")):(n=r,r=void 0);else throw Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");var o,i,a,s,u,l,f,c,h,d,p,g,y=this.length-e;if((void 0===r||r>y)&&(r=y),t.length>0&&(r<0||e<0)||e>this.length)throw RangeError("Attempt to write outside buffer bounds");n||(n="utf8");for(var v=!1;;)switch(n){case"hex":return function(t,e,r,n){r=Number(r)||0;var o=t.length-r;n?(n=Number(n))>o&&(n=o):n=o;var i=e.length;if(i%2!=0)throw TypeError("Invalid hex string");n>i/2&&(n=i/2);for(var a=0;a<n;++a){var s=parseInt(e.substr(2*a,2),16);if(isNaN(s))break;t[r+a]=s}return a}(this,t,e,r);case"utf8":case"utf-8":return u=e,l=r,O(S(t,this.length-u),this,u,l);case"ascii":return f=e,c=r,O(C(t),this,f,c);case"latin1":case"binary":return o=this,i=t,a=e,s=r,O(C(i),o,a,s);case"base64":return h=e,d=r,O(P(t),this,h,d);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return p=e,g=r,O(function(t,e){for(var r,n,o=[],i=0;i<t.length&&!((e-=2)<0);++i)n=(r=t.charCodeAt(i))>>8,o.push(r%256),o.push(n);return o}(t,this.length-p),this,p,g);default:if(v)throw TypeError("Unknown encoding: "+n);n=(""+n).toLowerCase(),v=!0}},u.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}},u.prototype.slice=function(t,e){var r,n=this.length;if(t=~~t,e=void 0===e?n:~~e,t<0?(t+=n)<0&&(t=0):t>n&&(t=n),e<0?(e+=n)<0&&(e=0):e>n&&(e=n),e<t&&(e=t),u.TYPED_ARRAY_SUPPORT)(r=this.subarray(t,e)).__proto__=u.prototype;else{var o=e-t;r=new u(o,void 0);for(var i=0;i<o;++i)r[i]=this[i+t]}return r},u.prototype.readUIntLE=function(t,e,r){t|=0,e|=0,r||_(t,e,this.length);for(var n=this[t],o=1,i=0;++i<e&&(o*=256);)n+=this[t+i]*o;return n},u.prototype.readUIntBE=function(t,e,r){t|=0,e|=0,r||_(t,e,this.length);for(var n=this[t+--e],o=1;e>0&&(o*=256);)n+=this[t+--e]*o;return n},u.prototype.readUInt8=function(t,e){return e||_(t,1,this.length),this[t]},u.prototype.readUInt16LE=function(t,e){return e||_(t,2,this.length),this[t]|this[t+1]<<8},u.prototype.readUInt16BE=function(t,e){return e||_(t,2,this.length),this[t]<<8|this[t+1]},u.prototype.readUInt32LE=function(t,e){return e||_(t,4,this.length),(this[t]|this[t+1]<<8|this[t+2]<<16)+16777216*this[t+3]},u.prototype.readUInt32BE=function(t,e){return e||_(t,4,this.length),16777216*this[t]+(this[t+1]<<16|this[t+2]<<8|this[t+3])},u.prototype.readIntLE=function(t,e,r){t|=0,e|=0,r||_(t,e,this.length);for(var n=this[t],o=1,i=0;++i<e&&(o*=256);)n+=this[t+i]*o;return n>=(o*=128)&&(n-=Math.pow(2,8*e)),n},u.prototype.readIntBE=function(t,e,r){t|=0,e|=0,r||_(t,e,this.length);for(var n=e,o=1,i=this[t+--n];n>0&&(o*=256);)i+=this[t+--n]*o;return i>=(o*=128)&&(i-=Math.pow(2,8*e)),i},u.prototype.readInt8=function(t,e){return(e||_(t,1,this.length),128&this[t])?-((255-this[t]+1)*1):this[t]},u.prototype.readInt16LE=function(t,e){e||_(t,2,this.length);var r=this[t]|this[t+1]<<8;return 32768&r?4294901760|r:r},u.prototype.readInt16BE=function(t,e){e||_(t,2,this.length);var r=this[t+1]|this[t]<<8;return 32768&r?4294901760|r:r},u.prototype.readInt32LE=function(t,e){return e||_(t,4,this.length),this[t]|this[t+1]<<8|this[t+2]<<16|this[t+3]<<24},u.prototype.readInt32BE=function(t,e){return e||_(t,4,this.length),this[t]<<24|this[t+1]<<16|this[t+2]<<8|this[t+3]},u.prototype.readFloatLE=function(t,e){return e||_(t,4,this.length),o.read(this,t,!0,23,4)},u.prototype.readFloatBE=function(t,e){return e||_(t,4,this.length),o.read(this,t,!1,23,4)},u.prototype.readDoubleLE=function(t,e){return e||_(t,8,this.length),o.read(this,t,!0,52,8)},u.prototype.readDoubleBE=function(t,e){return e||_(t,8,this.length),o.read(this,t,!1,52,8)},u.prototype.writeUIntLE=function(t,e,r,n){if(t=+t,e|=0,r|=0,!n){var o=Math.pow(2,8*r)-1;b(this,t,e,r,o,0)}var i=1,a=0;for(this[e]=255&t;++a<r&&(i*=256);)this[e+a]=t/i&255;return e+r},u.prototype.writeUIntBE=function(t,e,r,n){if(t=+t,e|=0,r|=0,!n){var o=Math.pow(2,8*r)-1;b(this,t,e,r,o,0)}var i=r-1,a=1;for(this[e+i]=255&t;--i>=0&&(a*=256);)this[e+i]=t/a&255;return e+r},u.prototype.writeUInt8=function(t,e,r){return t=+t,e|=0,r||b(this,t,e,1,255,0),u.TYPED_ARRAY_SUPPORT||(t=Math.floor(t)),this[e]=255&t,e+1},u.prototype.writeUInt16LE=function(t,e,r){return t=+t,e|=0,r||b(this,t,e,2,65535,0),u.TYPED_ARRAY_SUPPORT?(this[e]=255&t,this[e+1]=t>>>8):E(this,t,e,!0),e+2},u.prototype.writeUInt16BE=function(t,e,r){return t=+t,e|=0,r||b(this,t,e,2,65535,0),u.TYPED_ARRAY_SUPPORT?(this[e]=t>>>8,this[e+1]=255&t):E(this,t,e,!1),e+2},u.prototype.writeUInt32LE=function(t,e,r){return t=+t,e|=0,r||b(this,t,e,4,4294967295,0),u.TYPED_ARRAY_SUPPORT?(this[e+3]=t>>>24,this[e+2]=t>>>16,this[e+1]=t>>>8,this[e]=255&t):A(this,t,e,!0),e+4},u.prototype.writeUInt32BE=function(t,e,r){return t=+t,e|=0,r||b(this,t,e,4,4294967295,0),u.TYPED_ARRAY_SUPPORT?(this[e]=t>>>24,this[e+1]=t>>>16,this[e+2]=t>>>8,this[e+3]=255&t):A(this,t,e,!1),e+4},u.prototype.writeIntLE=function(t,e,r,n){if(t=+t,e|=0,!n){var o=Math.pow(2,8*r-1);b(this,t,e,r,o-1,-o)}var i=0,a=1,s=0;for(this[e]=255&t;++i<r&&(a*=256);)t<0&&0===s&&0!==this[e+i-1]&&(s=1),this[e+i]=(t/a>>0)-s&255;return e+r},u.prototype.writeIntBE=function(t,e,r,n){if(t=+t,e|=0,!n){var o=Math.pow(2,8*r-1);b(this,t,e,r,o-1,-o)}var i=r-1,a=1,s=0;for(this[e+i]=255&t;--i>=0&&(a*=256);)t<0&&0===s&&0!==this[e+i+1]&&(s=1),this[e+i]=(t/a>>0)-s&255;return e+r},u.prototype.writeInt8=function(t,e,r){return t=+t,e|=0,r||b(this,t,e,1,127,-128),u.TYPED_ARRAY_SUPPORT||(t=Math.floor(t)),t<0&&(t=255+t+1),this[e]=255&t,e+1},u.prototype.writeInt16LE=function(t,e,r){return t=+t,e|=0,r||b(this,t,e,2,32767,-32768),u.TYPED_ARRAY_SUPPORT?(this[e]=255&t,this[e+1]=t>>>8):E(this,t,e,!0),e+2},u.prototype.writeInt16BE=function(t,e,r){return t=+t,e|=0,r||b(this,t,e,2,32767,-32768),u.TYPED_ARRAY_SUPPORT?(this[e]=t>>>8,this[e+1]=255&t):E(this,t,e,!1),e+2},u.prototype.writeInt32LE=function(t,e,r){return t=+t,e|=0,r||b(this,t,e,4,2147483647,-2147483648),u.TYPED_ARRAY_SUPPORT?(this[e]=255&t,this[e+1]=t>>>8,this[e+2]=t>>>16,this[e+3]=t>>>24):A(this,t,e,!0),e+4},u.prototype.writeInt32BE=function(t,e,r){return t=+t,e|=0,r||b(this,t,e,4,2147483647,-2147483648),t<0&&(t=4294967295+t+1),u.TYPED_ARRAY_SUPPORT?(this[e]=t>>>24,this[e+1]=t>>>16,this[e+2]=t>>>8,this[e+3]=255&t):A(this,t,e,!1),e+4},u.prototype.writeFloatLE=function(t,e,r){return T(this,t,e,!0,r)},u.prototype.writeFloatBE=function(t,e,r){return T(this,t,e,!1,r)},u.prototype.writeDoubleLE=function(t,e,r){return x(this,t,e,!0,r)},u.prototype.writeDoubleBE=function(t,e,r){return x(this,t,e,!1,r)},u.prototype.copy=function(t,e,r,n){if(r||(r=0),n||0===n||(n=this.length),e>=t.length&&(e=t.length),e||(e=0),n>0&&n<r&&(n=r),n===r||0===t.length||0===this.length)return 0;if(e<0)throw RangeError("targetStart out of bounds");if(r<0||r>=this.length)throw RangeError("sourceStart out of bounds");if(n<0)throw RangeError("sourceEnd out of bounds");n>this.length&&(n=this.length),t.length-e<n-r&&(n=t.length-e+r);var o,i=n-r;if(this===t&&r<e&&e<n)for(o=i-1;o>=0;--o)t[o+e]=this[o+r];else if(i<1e3||!u.TYPED_ARRAY_SUPPORT)for(o=0;o<i;++o)t[o+e]=this[o+r];else Uint8Array.prototype.set.call(t,this.subarray(r,r+i),e);return i},u.prototype.fill=function(t,e,r,n){if("string"==typeof t){if("string"==typeof e?(n=e,e=0,r=this.length):"string"==typeof r&&(n=r,r=this.length),1===t.length){var o,i=t.charCodeAt(0);i<256&&(t=i)}if(void 0!==n&&"string"!=typeof n)throw TypeError("encoding must be a string");if("string"==typeof n&&!u.isEncoding(n))throw TypeError("Unknown encoding: "+n)}else"number"==typeof t&&(t&=255);if(e<0||this.length<e||this.length<r)throw RangeError("Out of range index");if(r<=e)return this;if(e>>>=0,r=void 0===r?this.length:r>>>0,t||(t=0),"number"==typeof t)for(o=e;o<r;++o)this[o]=t;else{var a=u.isBuffer(t)?t:S(new u(t,n).toString()),s=a.length;for(o=0;o<r-e;++o)this[o+e]=a[o%s]}return this};var I=/[^+\/0-9A-Za-z-_]/g;function S(t,e){e=e||1/0;for(var r,n=t.length,o=null,i=[],a=0;a<n;++a){if((r=t.charCodeAt(a))>55295&&r<57344){if(!o){if(r>56319||a+1===n){(e-=3)>-1&&i.push(239,191,189);continue}o=r;continue}if(r<56320){(e-=3)>-1&&i.push(239,191,189),o=r;continue}r=(o-55296<<10|r-56320)+65536}else o&&(e-=3)>-1&&i.push(239,191,189);if(o=null,r<128){if((e-=1)<0)break;i.push(r)}else if(r<2048){if((e-=2)<0)break;i.push(r>>6|192,63&r|128)}else if(r<65536){if((e-=3)<0)break;i.push(r>>12|224,r>>6&63|128,63&r|128)}else if(r<1114112){if((e-=4)<0)break;i.push(r>>18|240,r>>12&63|128,r>>6&63|128,63&r|128)}else throw Error("Invalid code point")}return i}function C(t){for(var e=[],r=0;r<t.length;++r)e.push(255&t.charCodeAt(r));return e}function P(t){return n.toByteArray(function(t){var e;if((t=((e=t).trim?e.trim():e.replace(/^\s+|\s+$/g,"")).replace(I,"")).length<2)return"";for(;t.length%4!=0;)t+="=";return t}(t))}function O(t,e,r,n){for(var o=0;o<n&&!(o+r>=e.length)&&!(o>=t.length);++o)e[o+r]=t[o];return o}},2344:function(t,e){/*! ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> */e.read=function(t,e,r,n,o){var i,a,s=8*o-n-1,u=(1<<s)-1,l=u>>1,f=-7,c=r?o-1:0,h=r?-1:1,d=t[e+c];for(c+=h,i=d&(1<<-f)-1,d>>=-f,f+=s;f>0;i=256*i+t[e+c],c+=h,f-=8);for(a=i&(1<<-f)-1,i>>=-f,f+=n;f>0;a=256*a+t[e+c],c+=h,f-=8);if(0===i)i=1-l;else{if(i===u)return a?NaN:1/0*(d?-1:1);a+=Math.pow(2,n),i-=l}return(d?-1:1)*a*Math.pow(2,i-n)},e.write=function(t,e,r,n,o,i){var a,s,u,l=8*i-o-1,f=(1<<l)-1,c=f>>1,h=23===o?5960464477539062e-23:0,d=n?0:i-1,p=n?1:-1,g=e<0||0===e&&1/e<0?1:0;for(isNaN(e=Math.abs(e))||e===1/0?(s=isNaN(e)?1:0,a=f):(a=Math.floor(Math.log(e)/Math.LN2),e*(u=Math.pow(2,-a))<1&&(a--,u*=2),a+c>=1?e+=h/u:e+=h*Math.pow(2,1-c),e*u>=2&&(a++,u/=2),a+c>=f?(s=0,a=f):a+c>=1?(s=(e*u-1)*Math.pow(2,o),a+=c):(s=e*Math.pow(2,c-1)*Math.pow(2,o),a=0));o>=8;t[r+d]=255&s,d+=p,s/=256,o-=8);for(a=a<<o|s,l+=o;l>0;t[r+d]=255&a,d+=p,a/=256,l-=8);t[r+d-p]|=128*g}},426:function(t){var e={}.toString;t.exports=Array.isArray||function(t){return"[object Array]"==e.call(t)}},7580:function(t){var e,r,n,o=t.exports={};function i(){throw Error("setTimeout has not been defined")}function a(){throw Error("clearTimeout has not been defined")}function s(t){if(e===setTimeout)return setTimeout(t,0);if((e===i||!e)&&setTimeout)return e=setTimeout,setTimeout(t,0);try{return e(t,0)}catch(r){try{return e.call(null,t,0)}catch(r){return e.call(this,t,0)}}}!function(){try{e="function"==typeof setTimeout?setTimeout:i}catch(t){e=i}try{r="function"==typeof clearTimeout?clearTimeout:a}catch(t){r=a}}();var u=[],l=!1,f=-1;function c(){l&&n&&(l=!1,n.length?u=n.concat(u):f=-1,u.length&&h())}function h(){if(!l){var t=s(c);l=!0;for(var e=u.length;e;){for(n=u,u=[];++f<e;)n&&n[f].run();f=-1,e=u.length}n=null,l=!1,function(t){if(r===clearTimeout)return clearTimeout(t);if((r===a||!r)&&clearTimeout)return r=clearTimeout,clearTimeout(t);try{r(t)}catch(e){try{return r.call(null,t)}catch(e){return r.call(this,t)}}}(t)}}function d(t,e){this.fun=t,this.array=e}function p(){}o.nextTick=function(t){var e=Array(arguments.length-1);if(arguments.length>1)for(var r=1;r<arguments.length;r++)e[r-1]=arguments[r];u.push(new d(t,e)),1!==u.length||l||s(h)},d.prototype.run=function(){this.fun.apply(null,this.array)},o.title="browser",o.browser=!0,o.env={},o.argv=[],o.version="",o.versions={},o.on=p,o.addListener=p,o.once=p,o.off=p,o.removeListener=p,o.removeAllListeners=p,o.emit=p,o.prependListener=p,o.prependOnceListener=p,o.listeners=function(t){return[]},o.binding=function(t){throw Error("process.binding is not supported")},o.cwd=function(){return"/"},o.chdir=function(t){throw Error("process.chdir is not supported")},o.umask=function(){return 0}},5883:function(t,e,r){"use strict";let n;r.d(e,{RJ:function(){return tE}}),r(35),r(7580);var o=((t,e=21)=>(r=e)=>{let n="",o=r;for(;o--;)n+=t[Math.random()*t.length|0];return n})("0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz",7),i={code:"0",name:"text",parse:t=>{if("string"!=typeof t)throw Error('"text" parts expect a string value.');return{type:"text",value:t}}},a={code:"1",name:"function_call",parse:t=>{if(null==t||"object"!=typeof t||!("function_call"in t)||"object"!=typeof t.function_call||null==t.function_call||!("name"in t.function_call)||!("arguments"in t.function_call)||"string"!=typeof t.function_call.name||"string"!=typeof t.function_call.arguments)throw Error('"function_call" parts expect an object with a "function_call" property.');return{type:"function_call",value:t}}},s={code:"2",name:"data",parse:t=>{if(!Array.isArray(t))throw Error('"data" parts expect an array value.');return{type:"data",value:t}}},u={code:"3",name:"error",parse:t=>{if("string"!=typeof t)throw Error('"error" parts expect a string value.');return{type:"error",value:t}}},l={code:"4",name:"assistant_message",parse:t=>{if(null==t||"object"!=typeof t||!("id"in t)||!("role"in t)||!("content"in t)||"string"!=typeof t.id||"string"!=typeof t.role||"assistant"!==t.role||!Array.isArray(t.content)||!t.content.every(t=>null!=t&&"object"==typeof t&&"type"in t&&"text"===t.type&&"text"in t&&null!=t.text&&"object"==typeof t.text&&"value"in t.text&&"string"==typeof t.text.value))throw Error('"assistant_message" parts expect an object with an "id", "role", and "content" property.');return{type:"assistant_message",value:t}}},f={code:"5",name:"assistant_control_data",parse:t=>{if(null==t||"object"!=typeof t||!("threadId"in t)||!("messageId"in t)||"string"!=typeof t.threadId||"string"!=typeof t.messageId)throw Error('"assistant_control_data" parts expect an object with a "threadId" and "messageId" property.');return{type:"assistant_control_data",value:{threadId:t.threadId,messageId:t.messageId}}}},c={code:"6",name:"data_message",parse:t=>{if(null==t||"object"!=typeof t||!("role"in t)||!("data"in t)||"string"!=typeof t.role||"data"!==t.role)throw Error('"data_message" parts expect an object with a "role" and "data" property.');return{type:"data_message",value:t}}},h={code:"7",name:"tool_calls",parse:t=>{if(null==t||"object"!=typeof t||!("tool_calls"in t)||"object"!=typeof t.tool_calls||null==t.tool_calls||!Array.isArray(t.tool_calls)||t.tool_calls.some(t=>null==t||"object"!=typeof t||!("id"in t)||"string"!=typeof t.id||!("type"in t)||"string"!=typeof t.type||!("function"in t)||null==t.function||"object"!=typeof t.function||!("arguments"in t.function)||"string"!=typeof t.function.name||"string"!=typeof t.function.arguments))throw Error('"tool_calls" parts expect an object with a ToolCallPayload.');return{type:"tool_calls",value:t}}},d={code:"8",name:"message_annotations",parse:t=>{if(!Array.isArray(t))throw Error('"message_annotations" parts expect an array value.');return{type:"message_annotations",value:t}}},p={code:"9",name:"tool_call",parse:t=>{if(null==t||"object"!=typeof t||!("toolCallId"in t)||"string"!=typeof t.toolCallId||!("toolName"in t)||"string"!=typeof t.toolName||!("args"in t)||"object"!=typeof t.args)throw Error('"tool_call" parts expect an object with a "toolCallId", "toolName", and "args" property.');return{type:"tool_call",value:t}}},g={code:"a",name:"tool_result",parse:t=>{if(null==t||"object"!=typeof t||!("toolCallId"in t)||"string"!=typeof t.toolCallId||!("toolName"in t)||"string"!=typeof t.toolName||!("args"in t)||"object"!=typeof t.args||!("result"in t))throw Error('"tool_result" parts expect an object with a "toolCallId", "toolName", "args", and "result" property.');return{type:"tool_result",value:t}}},y={[i.code]:i,[a.code]:a,[s.code]:s,[u.code]:u,[l.code]:l,[f.code]:f,[c.code]:c,[h.code]:h,[d.code]:d,[p.code]:p,[g.code]:g};i.name,i.code,a.name,a.code,s.name,s.code,u.name,u.code,l.name,l.code,f.name,f.code,c.name,c.code,h.name,h.code,d.name,d.code,p.name,p.code,g.name,g.code;var v=[i,a,s,u,l,f,c,h,d,p,g].map(t=>t.code),m=t=>{let e=t.indexOf(":");if(-1===e)throw Error("Failed to parse stream string. No separator found.");let r=t.slice(0,e);if(!v.includes(r))throw Error(`Failed to parse stream string. Invalid code ${r}.`);let n=JSON.parse(t.slice(e+1));return y[r].parse(n)};async function*w(t,{isAborted:e}={}){let r=new TextDecoder,n=[],o=0;for(;;){let{value:i}=await t.read();if(i&&(n.push(i),o+=i.length,10!==i[i.length-1]))continue;if(0===n.length)break;let a=function(t,e){let r=new Uint8Array(e),n=0;for(let e of t)r.set(e,n),n+=e.length;return t.length=0,r}(n,o);for(let t of(o=0,r.decode(a,{stream:!0}).split("\n").filter(t=>""!==t).map(m)))yield t;if(null==e?void 0:e()){t.cancel();break}}}function _(t,e){return t&&e&&e.length?{...t,annotations:[...e]}:t}async function b({reader:t,abortControllerRef:e,update:r,onToolCall:n,onFinish:i,generateId:a=o,getCurrentDate:s=()=>new Date}){let u;let l=s(),f={data:[]};for await(let{type:o,value:i}of w(t,{isAborted:()=>(null==e?void 0:e.current)===null})){if("text"===o&&(f.text?f.text={...f.text,content:(f.text.content||"")+i}:f.text={id:a(),role:"assistant",content:i,createdAt:l}),"tool_call"===o){if(null==f.text&&(f.text={id:a(),role:"assistant",content:"",createdAt:l}),null==f.text.toolInvocations&&(f.text.toolInvocations=[]),f.text.toolInvocations.push(i),n){let t=await n({toolCall:i});null!=t&&(f.text.toolInvocations[f.text.toolInvocations.length-1]={...i,result:t})}}else if("tool_result"===o){null==f.text&&(f.text={id:a(),role:"assistant",content:"",createdAt:l}),null==f.text.toolInvocations&&(f.text.toolInvocations=[]);let t=f.text.toolInvocations.findIndex(t=>t.toolCallId===i.toolCallId);-1!==t?f.text.toolInvocations[t]=i:f.text.toolInvocations.push(i)}let t=null;"function_call"===o&&(f.function_call={id:a(),role:"assistant",content:"",function_call:i.function_call,name:i.function_call.name,createdAt:l},t=f.function_call);let e=null;"tool_calls"===o&&(f.tool_calls={id:a(),role:"assistant",content:"",tool_calls:i.tool_calls,createdAt:l},e=f.tool_calls),"data"===o&&f.data.push(...i);let s=f.text;"message_annotations"===o&&(u?u.push(...i):u=[...i],t=_(f.function_call,u),e=_(f.tool_calls,u),s=_(f.text,u)),(null==u?void 0:u.length)&&["text","function_call","tool_calls"].forEach(t=>{f[t]&&(f[t].annotations=[...u])}),r([t,e,s].filter(Boolean).map(t=>({..._(t,u)})),[...f.data])}return null==i||i(f),{messages:[f.text,f.function_call,f.tool_calls].filter(Boolean),data:f.data}}async function E({api:t,messages:e,body:r,streamMode:n="stream-data",credentials:o,headers:i,abortController:a,restoreMessagesOnFailure:s,onResponse:u,onUpdate:l,onFinish:f,onToolCall:c,generateId:h}){var d;let p=await fetch(t,{method:"POST",body:JSON.stringify({messages:e,...r}),headers:{"Content-Type":"application/json",...i},signal:null==(d=null==a?void 0:a())?void 0:d.signal,credentials:o}).catch(t=>{throw s(),t});if(u)try{await u(p)}catch(t){throw t}if(!p.ok)throw s(),Error(await p.text()||"Failed to fetch the chat response.");if(!p.body)throw Error("The response body is empty.");let g=p.body.getReader();switch(n){case"text":{let t=function(t){let e=new TextDecoder;return function(t){return t?e.decode(t,{stream:!0}):""}}(),e={id:h(),createdAt:new Date,role:"assistant",content:""};for(;;){let{done:r,value:n}=await g.read();if(r)break;if(e.content+=t(n),e.id=h(),l([{...e}],[]),(null==a?void 0:a())===null){g.cancel();break}}return null==f||f(e),{messages:[e],data:[]}}case"stream-data":return await b({reader:g,abortControllerRef:null!=a?{current:a()}:void 0,update:l,onToolCall:c,onFinish(t){f&&null!=t.text&&f(t.text)},generateId:h});default:throw Error(`Unknown stream mode: ${n}`)}}async function A({getStreamedResponse:t,experimental_onFunctionCall:e,experimental_onToolCall:r,updateChatRequest:n,getCurrentMessages:o}){for(;;){let i=await t();if("messages"in i){let t=!1;for(let a of i.messages)if(void 0!==a.function_call&&"string"!=typeof a.function_call||void 0!==a.tool_calls&&"string"!=typeof a.tool_calls){if(t=!0,e){let r=a.function_call;if("object"!=typeof r){console.warn("experimental_onFunctionCall should not be defined when using tools");continue}let i=await e(o(),r);if(void 0===i){t=!1;break}n(i)}if(r){let e=a.tool_calls;if(!Array.isArray(e)||e.some(t=>"object"!=typeof t)){console.warn("experimental_onToolCall should not be defined when using tools");continue}let i=await r(o(),e);if(void 0===i){t=!1;break}n(i)}}if(!t)break}else{let t=function(t){for(let e of t.messages){if(void 0!==e.tool_calls)for(let t of e.tool_calls)"object"==typeof t&&t.function.arguments&&"string"!=typeof t.function.arguments&&(t.function.arguments=JSON.stringify(t.function.arguments));void 0!==e.function_call&&"object"==typeof e.function_call&&e.function_call.arguments&&"string"!=typeof e.function_call.arguments&&(e.function_call.arguments=JSON.stringify(e.function_call.arguments))}};if((void 0===i.function_call||"string"==typeof i.function_call)&&(void 0===i.tool_calls||"string"==typeof i.tool_calls))break;if(e){let r=i.function_call;if("object"!=typeof r){console.warn("experimental_onFunctionCall should not be defined when using tools");continue}let a=await e(o(),r);if(void 0===a)break;t(a),n(a)}if(r){let e=i.tool_calls;if("object"!=typeof e){console.warn("experimental_onToolCall should not be defined when using functions");continue}let a=await r(o(),e);if(void 0===a)break;t(a),n(a)}}}}var R=r(2265),T=r(554);let x=()=>{},I=x(),S=Object,C=t=>t===I,P=t=>"function"==typeof t,O=(t,e)=>({...t,...e}),U=t=>P(t.then),L=new WeakMap,k=0,B=t=>{let e,r;let n=typeof t,o=t&&t.constructor,i=o==Date;if(S(t)!==t||i||o==RegExp)e=i?t.toJSON():"symbol"==n?t.toString():"string"==n?JSON.stringify(t):""+t;else{if(e=L.get(t))return e;if(e=++k+"~",L.set(t,e),o==Array){for(r=0,e="@";r<t.length;r++)e+=B(t[r])+",";L.set(t,e)}if(o==S){e="#";let n=S.keys(t).sort();for(;!C(r=n.pop());)C(t[r])||(e+=r+":"+B(t[r])+",");L.set(t,e)}}return e},D=new WeakMap,j={},Y={},N="undefined",M=typeof window!=N,V=typeof document!=N,F=()=>M&&typeof window.requestAnimationFrame!=N,J=(t,e)=>{let r=D.get(t);return[()=>!C(e)&&t.get(e)||j,n=>{if(!C(e)){let o=t.get(e);e in Y||(Y[e]=o),r[5](e,O(o,n),o||j)}},r[6],()=>!C(e)&&e in Y?Y[e]:!C(e)&&t.get(e)||j]},z=!0,[W,q]=M&&window.addEventListener?[window.addEventListener.bind(window),window.removeEventListener.bind(window)]:[x,x],$={initFocus:t=>(V&&document.addEventListener("visibilitychange",t),W("focus",t),()=>{V&&document.removeEventListener("visibilitychange",t),q("focus",t)}),initReconnect:t=>{let e=()=>{z=!0,t()},r=()=>{z=!1};return W("online",e),W("offline",r),()=>{q("online",e),q("offline",r)}}},Z=!R.useId,G=!M||"Deno"in window,H=t=>F()?window.requestAnimationFrame(t):setTimeout(t,1),K=G?R.useEffect:R.useLayoutEffect,Q="undefined"!=typeof navigator&&navigator.connection,X=!G&&Q&&(["slow-2g","2g"].includes(Q.effectiveType)||Q.saveData),tt=t=>{if(P(t))try{t=t()}catch(e){t=""}let e=t;return[t="string"==typeof t?t:(Array.isArray(t)?t.length:t)?B(t):"",e]},te=0,tr=()=>++te;var tn={ERROR_REVALIDATE_EVENT:3,FOCUS_EVENT:0,MUTATE_EVENT:2,RECONNECT_EVENT:1};async function to(...t){let[e,r,n,o]=t,i=O({populateCache:!0,throwOnError:!0},"boolean"==typeof o?{revalidate:o}:o||{}),a=i.populateCache,s=i.rollbackOnError,u=i.optimisticData,l=!1!==i.revalidate,f=t=>"function"==typeof s?s(t):!1!==s,c=i.throwOnError;if(P(r)){let t=[];for(let n of e.keys())!/^\$(inf|sub)\$/.test(n)&&r(e.get(n)._k)&&t.push(n);return Promise.all(t.map(h))}return h(r);async function h(r){let o;let[i]=tt(r);if(!i)return;let[s,h]=J(e,i),[d,p,g,y]=D.get(e),v=d[i],m=()=>l&&(delete g[i],delete y[i],v&&v[0])?v[0](2).then(()=>s().data):s().data;if(t.length<3)return m();let w=n,_=tr();p[i]=[_,0];let b=!C(u),E=s(),A=E.data,R=E._c,T=C(R)?A:R;if(b&&h({data:u=P(u)?u(T,A):u,_c:T}),P(w))try{w=w(T)}catch(t){o=t}if(w&&U(w)){if(w=await w.catch(t=>{o=t}),_!==p[i][0]){if(o)throw o;return w}o&&b&&f(o)&&(a=!0,h({data:w=T,_c:I}))}a&&!o&&(P(a)&&(w=a(w,T)),h({data:w,error:I,_c:I})),p[i][1]=tr();let x=await m();if(h({_c:I}),o){if(c)throw o;return}return a?x:w}}let ti=(t,e)=>{for(let r in t)t[r][0]&&t[r][0](e)},ta=(t,e)=>{if(!D.has(t)){let r=O($,e),n={},o=to.bind(I,t),i=x,a={},s=(t,e)=>{let r=a[t]||[];return a[t]=r,r.push(e),()=>r.splice(r.indexOf(e),1)},u=(e,r,n)=>{t.set(e,r);let o=a[e];if(o)for(let t of o)t(r,n)},l=()=>{if(!D.has(t)&&(D.set(t,[n,{},{},{},o,u,s]),!G)){let e=r.initFocus(setTimeout.bind(I,ti.bind(I,n,0))),o=r.initReconnect(setTimeout.bind(I,ti.bind(I,n,1)));i=()=>{e&&e(),o&&o(),D.delete(t)}}};return l(),[t,o,l,i]}return[t,D.get(t)[4]]},[ts,tu]=ta(new Map),tl=O({onLoadingSlow:x,onSuccess:x,onError:x,onErrorRetry:(t,e,r,n,o)=>{let i=r.errorRetryCount,a=o.retryCount,s=~~((Math.random()+.5)*(1<<(a<8?a:8)))*r.errorRetryInterval;(C(i)||!(a>i))&&setTimeout(n,s,o)},onDiscarded:x,revalidateOnFocus:!0,revalidateOnReconnect:!0,revalidateIfStale:!0,shouldRetryOnError:!0,errorRetryInterval:X?1e4:5e3,focusThrottleInterval:5e3,dedupingInterval:2e3,loadingTimeout:X?5e3:3e3,compare:(t,e)=>B(t)==B(e),isPaused:()=>!1,cache:ts,mutate:tu,fallback:{}},{isOnline:()=>z,isVisible:()=>{let t=V&&document.visibilityState;return C(t)||"hidden"!==t}}),tf=(t,e)=>{let r=O(t,e);if(e){let{use:n,fallback:o}=t,{use:i,fallback:a}=e;n&&i&&(r.use=n.concat(i)),o&&a&&(r.fallback=O(o,a))}return r},tc=(0,R.createContext)({}),th=M&&window.__SWR_DEVTOOLS_USE__,td=th?window.__SWR_DEVTOOLS_USE__:[],tp=t=>P(t[1])?[t[0],t[1],t[2]||{}]:[t[0],null,(null===t[1]?t[2]:t[1])||{}],tg=()=>O(tl,(0,R.useContext)(tc)),ty=td.concat(t=>(e,r,n)=>{let o=r&&((...t)=>{let[n]=tt(e),[,,,o]=D.get(ts),i=o[n];return C(i)?r(...t):(delete o[n],i)});return t(e,o,n)}),tv=(t,e,r)=>{let n=e[t]||(e[t]=[]);return n.push(r),()=>{let t=n.indexOf(r);t>=0&&(n[t]=n[n.length-1],n.pop())}};th&&(window.__SWR_DEVTOOLS_REACT__=R);let tm=R.use||(t=>{if("pending"===t.status)throw t;if("fulfilled"===t.status)return t.value;if("rejected"===t.status)throw t.reason;throw t.status="pending",t.then(e=>{t.status="fulfilled",t.value=e},e=>{t.status="rejected",t.reason=e}),t}),tw={dedupe:!0};S.defineProperty(t=>{let{value:e}=t,r=(0,R.useContext)(tc),n=P(e),o=(0,R.useMemo)(()=>n?e(r):e,[n,r,e]),i=(0,R.useMemo)(()=>n?o:tf(r,o),[n,r,o]),a=o&&o.provider,s=(0,R.useRef)(I);a&&!s.current&&(s.current=ta(a(i.cache||ts),o));let u=s.current;return u&&(i.cache=u[0],i.mutate=u[1]),K(()=>{if(u)return u[2]&&u[2](),u[3]},[]),(0,R.createElement)(tc.Provider,O(t,{value:i}))},"defaultValue",{value:tl});let t_=(n=(t,e,r)=>{let{cache:n,compare:o,suspense:i,fallbackData:a,revalidateOnMount:s,revalidateIfStale:u,refreshInterval:l,refreshWhenHidden:f,refreshWhenOffline:c,keepPreviousData:h}=r,[d,p,g,y]=D.get(n),[v,m]=tt(t),w=(0,R.useRef)(!1),_=(0,R.useRef)(!1),b=(0,R.useRef)(v),E=(0,R.useRef)(e),A=(0,R.useRef)(r),x=()=>A.current,S=()=>x().isVisible()&&x().isOnline(),[U,L,k,B]=J(n,v),j=(0,R.useRef)({}).current,Y=C(a)?r.fallback[v]:a,N=(t,e)=>{for(let r in j)if("data"===r){if(!o(t[r],e[r])&&(!C(t[r])||!o(X,e[r])))return!1}else if(e[r]!==t[r])return!1;return!0},M=(0,R.useMemo)(()=>{let t=!!v&&!!e&&(C(s)?!x().isPaused()&&!i&&(!!C(u)||u):s),r=e=>{let r=O(e);return(delete r._k,t)?{isValidating:!0,isLoading:!0,...r}:r},n=U(),o=B(),a=r(n),l=n===o?a:r(o),f=a;return[()=>{let t=r(U());return N(t,f)?(f.data=t.data,f.isLoading=t.isLoading,f.isValidating=t.isValidating,f.error=t.error,f):(f=t,t)},()=>l]},[n,v]),V=(0,T.useSyncExternalStore)((0,R.useCallback)(t=>k(v,(e,r)=>{N(r,e)||t()}),[n,v]),M[0],M[1]),F=!w.current,z=d[v]&&d[v].length>0,W=V.data,q=C(W)?Y:W,$=V.error,Q=(0,R.useRef)(q),X=h?C(W)?Q.current:W:q,te=(!z||!!C($))&&(F&&!C(s)?s:!x().isPaused()&&(i?!C(q)&&u:C(q)||u)),ti=!!(v&&e&&F&&te),ta=C(V.isValidating)?ti:V.isValidating,ts=C(V.isLoading)?ti:V.isLoading,tu=(0,R.useCallback)(async t=>{let e,n;let i=E.current;if(!v||!i||_.current||x().isPaused())return!1;let a=!0,s=t||{},u=!g[v]||!s.dedupe,l=()=>Z?!_.current&&v===b.current&&w.current:v===b.current,f={isValidating:!1,isLoading:!1},c=()=>{L(f)},h=()=>{let t=g[v];t&&t[1]===n&&delete g[v]},y={isValidating:!0};C(U().data)&&(y.isLoading=!0);try{if(u&&(L(y),r.loadingTimeout&&C(U().data)&&setTimeout(()=>{a&&l()&&x().onLoadingSlow(v,r)},r.loadingTimeout),g[v]=[i(m),tr()]),[e,n]=g[v],e=await e,u&&setTimeout(h,r.dedupingInterval),!g[v]||g[v][1]!==n)return u&&l()&&x().onDiscarded(v),!1;f.error=I;let t=p[v];if(!C(t)&&(n<=t[0]||n<=t[1]||0===t[1]))return c(),u&&l()&&x().onDiscarded(v),!1;let s=U().data;f.data=o(s,e)?s:e,u&&l()&&x().onSuccess(e,v,r)}catch(r){h();let t=x(),{shouldRetryOnError:e}=t;!t.isPaused()&&(f.error=r,u&&l()&&(t.onError(r,v,t),(!0===e||P(e)&&e(r))&&S()&&t.onErrorRetry(r,v,t,t=>{let e=d[v];e&&e[0]&&e[0](tn.ERROR_REVALIDATE_EVENT,t)},{retryCount:(s.retryCount||0)+1,dedupe:!0})))}return a=!1,c(),!0},[v,n]),tl=(0,R.useCallback)((...t)=>to(n,b.current,...t),[]);if(K(()=>{E.current=e,A.current=r,C(W)||(Q.current=W)}),K(()=>{if(!v)return;let t=tu.bind(I,tw),e=0,r=tv(v,d,(r,n={})=>{if(r==tn.FOCUS_EVENT){let r=Date.now();x().revalidateOnFocus&&r>e&&S()&&(e=r+x().focusThrottleInterval,t())}else if(r==tn.RECONNECT_EVENT)x().revalidateOnReconnect&&S()&&t();else if(r==tn.MUTATE_EVENT)return tu();else if(r==tn.ERROR_REVALIDATE_EVENT)return tu(n)});return _.current=!1,b.current=v,w.current=!0,L({_k:m}),te&&(C(q)||G?t():H(t)),()=>{_.current=!0,r()}},[v]),K(()=>{let t;function e(){let e=P(l)?l(U().data):l;e&&-1!==t&&(t=setTimeout(r,e))}function r(){!U().error&&(f||x().isVisible())&&(c||x().isOnline())?tu(tw).then(e):e()}return e(),()=>{t&&(clearTimeout(t),t=-1)}},[l,f,c,v]),(0,R.useDebugValue)(X),i&&C(q)&&v){if(!Z&&G)throw Error("Fallback data is required when using suspense in SSR.");E.current=e,A.current=r,_.current=!1;let t=y[v];if(C(t)||tm(tl(t)),C($)){let t=tu(tw);C(X)||(t.status="fulfilled",t.value=!0),tm(t)}else throw $}return{mutate:tl,get data(){return j.data=!0,X},get error(){return j.error=!0,$},get isValidating(){return j.isValidating=!0,ta},get isLoading(){return j.isLoading=!0,ts}}},function(...t){let e=tg(),[r,o,i]=tp(t),a=tf(e,i),s=n,{use:u}=a,l=(u||[]).concat(ty);for(let t=l.length;t--;)s=l[t](s);return s(r,o||a.fetcher||null,a)});var tb=async(t,e,r,n,o,i,a,s,u,l,f,c,h,d)=>{var p,g;let y=a.current;r(e.messages,!1);let v=d?e.messages:e.messages.map(({role:t,content:e,name:r,data:n,annotations:o,toolInvocations:i,function_call:a,tool_calls:s,tool_call_id:u})=>({role:t,content:e,...void 0!==r&&{name:r},...void 0!==n&&{data:n},...void 0!==o&&{annotations:o},...void 0!==i&&{toolInvocations:i},tool_call_id:u,...void 0!==a&&{function_call:a},...void 0!==s&&{tool_calls:s}}));return await E({api:t,messages:v,body:{data:e.data,...i.current.body,...null==(p=e.options)?void 0:p.body,...void 0!==e.functions&&{functions:e.functions},...void 0!==e.function_call&&{function_call:e.function_call},...void 0!==e.tools&&{tools:e.tools},...void 0!==e.tool_choice&&{tool_choice:e.tool_choice}},streamMode:l,credentials:i.current.credentials,headers:{...i.current.headers,...null==(g=e.options)?void 0:g.headers},abortController:()=>s.current,restoreMessagesOnFailure(){r(y,!1)},onResponse:c,onUpdate(t,i){r([...e.messages,...t],!1),n([...o||[],...i||[]],!1)},onToolCall:h,onFinish:f,generateId:u})};function tE({api:t="/api/chat",id:e,initialMessages:r,initialInput:n="",sendExtraMessageFields:i,experimental_onFunctionCall:a,experimental_onToolCall:s,onToolCall:u,experimental_maxAutomaticRoundtrips:l=0,maxAutomaticRoundtrips:f=l,maxToolRoundtrips:c=f,streamMode:h,onResponse:d,onFinish:p,onError:g,credentials:y,headers:v,body:m,generateId:w=o}={}){let _=(0,R.useId)(),b=null!=e?e:_,E="string"==typeof t?[t,b]:b,[T]=(0,R.useState)([]),{data:x,mutate:I}=t_([E,"messages"],null,{fallbackData:null!=r?r:T}),{data:S=!1,mutate:C}=t_([E,"loading"],null),{data:P,mutate:O}=t_([E,"streamData"],null),{data:U,mutate:L}=t_([E,"error"],null),k=(0,R.useRef)(x||[]);(0,R.useEffect)(()=>{k.current=x||[]},[x]);let B=(0,R.useRef)(null),D=(0,R.useRef)({credentials:y,headers:v,body:m});(0,R.useEffect)(()=>{D.current={credentials:y,headers:v,body:m}},[y,v,m]);let j=(0,R.useCallback)(async e=>{try{C(!0),L(void 0);let r=new AbortController;B.current=r,await A({getStreamedResponse:()=>tb(t,e,I,O,P,D,k,B,w,h,p,d,u,i),experimental_onFunctionCall:a,experimental_onToolCall:s,updateChatRequest:t=>{e=t},getCurrentMessages:()=>k.current}),B.current=null}catch(t){if("AbortError"===t.name)return B.current=null,null;g&&t instanceof Error&&g(t),L(t)}finally{C(!1)}let r=k.current,n=r[r.length-1];null!=n&&c>0&&tA(n)&&function(t){let e=0;for(let r=t.length-1;r>=0;r--)if("assistant"===t[r].role)e++;else break;return e}(r)<=c&&await j({messages:r})},[I,C,t,D,d,p,g,L,O,P,h,i,a,s,u,c,k,B,w]),Y=(0,R.useCallback)(async(t,{options:e,functions:r,function_call:n,tools:o,tool_choice:i,data:a}={})=>(t.id||(t.id=w()),j({messages:k.current.concat(t),options:e,data:a,...void 0!==r&&{functions:r},...void 0!==n&&{function_call:n},...void 0!==o&&{tools:o},...void 0!==i&&{tool_choice:i}})),[j,w]),N=(0,R.useCallback)(async({options:t,functions:e,function_call:r,tools:n,tool_choice:o}={})=>0===k.current.length?null:"assistant"===k.current[k.current.length-1].role?j({messages:k.current.slice(0,-1),options:t,...void 0!==e&&{functions:e},...void 0!==r&&{function_call:r},...void 0!==n&&{tools:n},...void 0!==o&&{tool_choice:o}}):j({messages:k.current,options:t,...void 0!==e&&{functions:e},...void 0!==r&&{function_call:r},...void 0!==n&&{tools:n},...void 0!==o&&{tool_choice:o}}),[j]),M=(0,R.useCallback)(()=>{B.current&&(B.current.abort(),B.current=null)},[]),V=(0,R.useCallback)(t=>{I(t,!1),k.current=t},[I]),[F,J]=(0,R.useState)(n),z=(0,R.useCallback)((t,e={},r)=>{r&&(D.current={...D.current,...r}),t.preventDefault(),F&&(Y({content:F,role:"user",createdAt:new Date},e),J(""))},[F,Y]),W=({toolCallId:t,result:e})=>{let r=k.current.map((r,n,o)=>n===o.length-1&&"assistant"===r.role&&r.toolInvocations?{...r,toolInvocations:r.toolInvocations.map(r=>r.toolCallId===t?{...r,result:e}:r)}:r);I(r,!1),tA(r[r.length-1])&&j({messages:r})};return{messages:x||[],error:U,append:Y,reload:N,stop:M,setMessages:V,input:F,setInput:J,handleInputChange:t=>{J(t.target.value)},handleSubmit:z,isLoading:S,data:P,addToolResult:W,experimental_addToolResult:W}}function tA(t){return"assistant"===t.role&&t.toolInvocations&&t.toolInvocations.length>0&&t.toolInvocations.every(t=>"result"in t)}}}]);